<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Premium Car Rentals</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="{{ url_for('static', filename='css/home.css') }}" rel="stylesheet">
</head>
<body>
    <nav class="top-nav">
        {% if session.get('customer_id') %}
        <div class="profile-dropdown">
            <button class="profile-btn">
                <i class="fas fa-user"></i>
                <span>{{ session.customer_name }}</span>
                <i class="fas fa-chevron-down"></i>
            </button>
            
            <div class="dropdown-content">
                <a href="{{ url_for('cars') }}" class="dropdown-item">Browse Cars</a>
                <a href="{{ url_for('edit_profile') }}" class="dropdown-item">Edit Profile</a>
                <div class="dropdown-divider"></div>
                <a href="{{ url_for('logout') }}" class="dropdown-item logout-btn">Logout</a>
            </div>
        </div>
        {% endif %}
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <img src="{{ url_for('static', filename='images/logo/home-logo.png') }}" alt="Premium Car Rentals" class="logo-image">
        <p>We Provide Best Cars With The Best Prices. We Are Expert In Car Rental. Enjoy Your Holidays With Us. We Make Your Drive Memorable. We Care For Your Safety.</p>
        <div class="hero-buttons">
            <a href="{{ url_for('cars') }}" class="learn-more-btn">Browse Cars</a>
            {% if not session.get('customer_id') %}
            <a href="{{ url_for('login') }}" class="secondary-btn">Login</a>
            <a href="{{ url_for('register') }}" class="success-btn">Register</a>
            {% endif %}
        </div>
    </section>

    <!-- Features Section -->
    <section class="features">
        <h2>Why Choose Our Service</h2>
        <div class="features-grid">
            <div class="feature-card" style="--card-index: 0">
                <i class="fas fa-clock"></i>
                <h3>Quick & Easy Booking</h3>
                <p>Book your car in minutes with our simple and intuitive booking system.</p>
            </div>

            <div class="feature-card" style="--card-index: 1">
                <i class="fas fa-shield-alt"></i>
                <h3>Safe & Reliable</h3>
                <p>All our vehicles are regularly maintained and sanitized for your safety.</p>
            </div>

            <div class="feature-card" style="--card-index: 2">
                <i class="fas fa-dollar-sign"></i>
                <h3>Best Price Guarantee</h3>
                <p>We offer competitive prices with no hidden fees or charges.</p>
            </div>

            <div class="feature-card" style="--card-index: 3">
                <i class="fas fa-headset"></i>
                <h3>24/7 Support</h3>
                <p>Round-the-clock customer assistance for all your needs.</p>
            </div>
        </div>
    </section>

    <!-- Popular Cars Section -->
    <section class="popular-cars">
        <h2>Our Popular Cars</h2>
        <p class="section-subtitle">Explore our most popular rental options</p>
        <div class="cars-grid">
            <div class="car-card">
                <div class="car-image">
                    <img src="https://images.unsplash.com/photo-1580273916550-e323be2ae537?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="BMW M4">
                </div>
                <div class="car-details">
                    <h3>BMW M4</h3>
                    <p>Luxury sports car with exceptional performance</p>
                    <div class="car-meta">
                        <span class="car-price">$150/day</span>
                        <span class="car-status available">Available</span>
                    </div>
                </div>
            </div>

            <div class="car-card">
                <div class="car-image">
                    <img src="https://images.unsplash.com/photo-1676856577533-1e8099932f7b?q=80&w=2021&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Tesla Model S">
                </div>
                <div class="car-details">
                    <h3>Tesla Model S</h3>
                    <p>Electric luxury sedan with cutting-edge tech</p>
                    <div class="car-meta">
                        <span class="car-price">$180/day</span>
                        <span class="car-status available">Available</span>
                    </div>
                </div>
            </div>

            <div class="car-card">
                <div class="car-image">
                    <img src="https://images.unsplash.com/photo-1634673970798-a15ae56f6c65?q=80&w=2128&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Porsche 911">
                </div>
                <div class="car-details">
                    <h3>Porsche 911</h3>
                    <p>Classic sports car with modern performance</p>
                    <div class="car-meta">
                        <span class="car-price">$200/day</span>
                        <span class="car-status available">Available</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section class="contact">
        <h2>Get In Touch</h2>
        <div class="contact-info">
            <div class="contact-card">
                <i class="fas fa-phone"></i>
                <h3>Call Us</h3>
                <p>(863) 706-7507</p>
            </div>
            <div class="contact-card">
                <i class="fas fa-envelope"></i>
                <h3>Email Us</h3>
                <p>cyrax.3589@gmail.com</p>
            </div>
            <div class="contact-card">
                <i class="fas fa-map-marker-alt"></i>
                <h3>Visit Us</h3>
                <p>ACSCE, Chalaghatta, Kengeri, Bangalore, 560060</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>Premium Car Rentals</h3>
                <p>Your trusted partner for premium car rentals since 2023.</p>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul>
                    {% if not session.get('customer_id') %}
                    <li><a href="{{ url_for('login') }}">Login</a></li>
                    <li><a href="{{ url_for('register') }}">Register</a></li>
                    {% endif %}
                    <li><a href="{{ url_for('policy') }}" target="_blank">Privacy Policy</a></li>
                    <li><a href="{{ url_for('terms') }}" target="_blank">Terms Of Service</a></li>
                    <li><a href="{{ url_for('disclaimer') }}" target="_blank">Disclaimer</a></li>
                    <li><a href="{{ url_for('FAQs') }}" target="_blank">FAQs</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Follow Us</h3>
                <div class="social-icons">
                    <a href="https://www.facebook.com/debabrata.kuiry.10" target="_blank"><i class="fab fa-facebook"></i></a>
                    <a href="https://github.com/cyrax3589" target="_blank"><i class="fab fa-github"></i></a>
                    <a href="https://www.instagram.com/_deb.3589/" target="_blank"><i class="fab fa-instagram"></i></a>
                    <a href="https://www.linkedin.com/in/debabrata-kuiry-056b9720a/" target="_blank"><i class="fab fa-linkedin"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2023 Premium Car Rentals. All rights reserved.</p>
        </div>
    </footer>

    <div class="chatbot">
    <div id="chatbot-widget" style="position:fixed;bottom:30px;right:30px;z-index:9999;">
        <div id="chatbot-box" style="width:320px;max-height:450px;background:#fff;border-radius:12px;box-shadow:0 5px 25px rgba(0,0,0,0.2);display:none;flex-direction:column;margin-bottom:15px;overflow:hidden;border:1px solid #e0e0e0;">
            <div style="background:#ffffff;color:#414141;padding:12px 16px;font-weight:600;display:flex;justify-content:space-between;align-items:center;">
                <div style="display:flex;align-items:center;gap:8px;">
                    <img src="{{ url_for('static', filename='images/logo/chatbot_logo.png') }}" alt="AI" style="width:20px;height:20px;">
                    <span>Vroomie AI</span>
                </div>
                <button onclick="closeChatbot()" style="background:none;border:none;color:#414141;font-size:18px;cursor:pointer;padding:0;display:flex;align-items:center;justify-content:center;width:24px;height:24px;">&#10008;</button>
            </div>
            <div id="chatbot-messages" style="flex:1;overflow-y:auto;padding:16px;height:280px;background:#f9fafc;font-size:14px;line-height:1.5;"></div>
            <form id="chatbot-form" style="display:flex;border-top:1px solid #eee;background:white;" onsubmit="return sendMessage(event)">
                <input id="chatbot-input" type="text" placeholder="Type your message here..." autocomplete="off" style="flex:1;padding:14px;border:none;outline:none;font-size:14px;font-family:'Poppins',sans-serif;">
                <button type="submit" style="background:#eee;color:#0d0ada;border:none;padding:0 18px;cursor:pointer;font-weight:900;transition:background 0.2s ease;">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </form>
        </div>
        <button onclick="openChatbot()" style="width:60px;height:60px;border-radius:50%;background:#ffffff;color:#fff;font-size:24px;border:none;box-shadow:0 4px 12px rgba(37,99,235,0.3);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:transform 0.2s ease,box-shadow 0.2s ease;">
            <img src="{{ url_for('static', filename='images/logo/chatbot_logo.png') }}" alt="Chat" style="width:32px;height:32px;">
        </button>
    </div>
    </div>

    <script>
    function openChatbot() {
        document.getElementById('chatbot-box').style.display = 'flex';
        document.getElementById('chatbot-input').focus();
    }
    function closeChatbot() {
        document.getElementById('chatbot-box').style.display = 'none';
    }
    function appendMessage(sender, text) {
        const msgDiv = document.createElement('div');
        msgDiv.style.margin = '10px 0';
        msgDiv.style.padding = '8px 12px';
        msgDiv.style.borderRadius = '12px';
        msgDiv.style.maxWidth = '85%';
        msgDiv.style.wordBreak = 'break-word';
        
        if (sender === 'You') {
            msgDiv.style.backgroundColor = '#2563eb';
            msgDiv.style.color = 'white';
            msgDiv.style.marginLeft = 'auto';
            msgDiv.innerHTML = `${text}`;
        } else {
            msgDiv.style.backgroundColor = '#e9ecef';
            msgDiv.style.color = '#333';
            msgDiv.style.marginRight = 'auto';
            msgDiv.innerHTML = `${text}`;
        }
        
        document.getElementById('chatbot-messages').appendChild(msgDiv);
        document.getElementById('chatbot-messages').scrollTop = document.getElementById('chatbot-messages').scrollHeight;
    }
    
    // Add typing indicator function
    function showTypingIndicator() {
        const typingDiv = document.createElement('div');
        typingDiv.id = 'typing-indicator';
        typingDiv.style.margin = '10px 0';
        typingDiv.style.padding = '8px 12px';
        typingDiv.style.borderRadius = '12px';
        typingDiv.style.backgroundColor = '#e9ecef';
        typingDiv.style.color = '#333';
        typingDiv.style.marginRight = 'auto';
        typingDiv.style.maxWidth = '60px';
        typingDiv.style.display = 'flex';
        typingDiv.style.alignItems = 'center';
        typingDiv.style.justifyContent = 'center';
        
        // Create typing animation dots
        typingDiv.innerHTML = `
            <div class="typing-dots">
                <span class="dot"></span>
                <span class="dot"></span>
                <span class="dot"></span>
            </div>
        `;
        
        document.getElementById('chatbot-messages').appendChild(typingDiv);
        document.getElementById('chatbot-messages').scrollTop = document.getElementById('chatbot-messages').scrollHeight;
        
        // Add animation style
        const style = document.createElement('style');
        style.textContent = `
            .typing-dots {
                display: flex;
                gap: 4px;
            }
            .dot {
                width: 6px;
                height: 6px;
                background-color: #666;
                border-radius: 50%;
                opacity: 0.6;
            }
            .dot:nth-child(1) {
                animation: pulse 1.2s infinite ease-in-out;
            }
            .dot:nth-child(2) {
                animation: pulse 1.2s infinite ease-in-out 0.4s;
            }
            .dot:nth-child(3) {
                animation: pulse 1.2s infinite ease-in-out 0.8s;
            }
            @keyframes pulse {
                0%, 100% {
                    opacity: 0.6;
                    transform: scale(1);
                }
                50% {
                    opacity: 1;
                    transform: scale(1.2);
                }
            }
        `;
        document.head.appendChild(style);
    }
    
    function removeTypingIndicator() {
        const typingIndicator = document.getElementById('typing-indicator');
        if (typingIndicator) {
            typingIndicator.remove();
        }
    }
    
    async function sendMessage(e) {
        e.preventDefault();
        const input = document.getElementById('chatbot-input');
        const text = input.value.trim();
        if (!text) return false;
        
        appendMessage('You', text);
        input.value = '';
        
        // Show typing indicator
        showTypingIndicator();
        
        // Call RAG chatbot API
        const resp = await fetch('/RAG_chatbot', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({message: text})
        });
        const data = await resp.json();
        
        // Add artificial delay to simulate thinking (between 1-2 seconds)
        const thinkingTime = Math.floor(Math.random() * 1000) + 1000;
        await new Promise(resolve => setTimeout(resolve, thinkingTime));
        
        // Remove typing indicator and add response
        removeTypingIndicator();
        appendMessage('Bot', data.reply || 'Sorry, no response.');
        return false;
    }
    </script>
    <script>
        const profileBtn = document.querySelector('.profile-btn');
        const dropdownContent = document.querySelector('.dropdown-content');

        profileBtn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            dropdownContent.classList.toggle('show-dropdown');
        });

        document.addEventListener('click', function(e) {
            if (!profileBtn.contains(e.target) && !dropdownContent.contains(e.target)) {
                dropdownContent.classList.remove('show-dropdown');
            }
        });
    </script>
</body>
</html>